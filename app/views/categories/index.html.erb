<h1>Categories_index</h1>

<div class="container">
  <div class="row gx-2">
    <div class="col-3 border p-3">
      <p class="lead">投稿エリア</p>
      <%= render 'post-form' %>
    </div>

    <div class="col-6 border p-3">
      <p class="lead">indexエリア</p>
      <%= paginate @categories, theme: 'bootstrap-5' %>
      <% @categories.each do |category| %>
        <div class="todo-list-area border p-2 my-2">
          <div class="category-title-area d-flex justify-content-between">
            <p class="fw-bold"><%= category.title %></p>
            <%= link_to '完了', category_path(category.id), method: :delete, class: "btn btn-outline-danger",
            data: { confirm: "ToDo「#{category.title}」を完了します。よろしいですか？" } %>
          </div>
          <% category.todos.active.each do |todo| %>
            <div class="todo-show-area d-flex justify-content-between py-1">
              <p><%= todo.content %></p>
              <%= link_to '完了', category_todo_path(todo.category.id, todo.id), method: :delete, class: "btn btn-outline-danger",
              data: { confirm: "ToDo「#{category.title}」を完了します。よろしいですか？" } %>
            </div>
          <% end %>
          <div class="new-todo-area">
            <%= form_with model: [category, @add_todo] do |f| %>
              <%= f.text_field :content %>
              <%= f.submit '追加' %>
            <% end %>
          </div>
          <div class="edit-category-area">
            <%= link_to '編集', edit_category_path(category.id), class: "btn btn-outline-secondary mt-2" %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="col-3 border p-3">
      <p class="lead">ユーザーエリア(demo)</p>
      <div>
      ・ユーザー名: sample<br>
      ・残カテゴリ数: <%= "#{Category.active.count}" %><br>
      ・達成カテゴリ数: <%= "#{Category.all.count - Category.active.count} / #{Category.all.count}" %><br>
      </div>
    </div>
  </div>
</div>