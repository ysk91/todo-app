<h1>Categoies_index</h1>

<div class="container">
  <div class="row gx-2">
    <div class="col-3 border p-3">
      <p class="lead">投稿エリア</p>

      <%= form_with model: @category do |f| %>
        <div class="category-post-area mb-3">
          <%= f.label 'カテゴリ', class: 'form-label fw-bold' %><br>
          <%= f.text_field :title %>
        </div>
        <div class="todos-post-area mb-3">
          <p class="fw-bold">ToDo</p>
          <%= f.fields_for :todos do |t| %>
            <%= t.text_field :content, class: "my-1" %>
          <% end %>
        </div>
        <%= f.submit '投稿', class: "btn btn-primary" %>
      <% end %>
    </div>

    <div class="col-6 border p-3">
      <p class="lead">indexエリア</p>
      <% @categories.each do |category| %>
        <div class="todo-list-area border p-2 my-2">
          <div class="category-title-area d-flex justify-content-between">
            <p class="fw-bold"><%= category.title %></p>
            <%= link_to '完了', category_path(category.id), method: :delete, class: "btn btn-outline-danger",
            data: { confirm: "ToDo「#{category.title}」を完了します。よろしいですか？" } %>
          </div>
          <% category.todos.active.each do |todo| %>
            <div class="todo-show-area d-flex justify-content-between py-1">
              <p><%= todo.content %></p>
              <%= link_to '完了', category_todo_path(todo.category.id, todo.id), method: :delete, class: "btn btn-outline-danger",
              data: { confirm: "ToDo「#{category.title}」を完了します。よろしいですか？" } %>
            </div>
          <% end %>
          <div class="new-todo-area">
            <%= form_with model: [category, @add_todo] do |f| %>
              <%= f.text_field :content %>
              <%= f.submit '追加' %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="col-3 border p-3">
      <p class="lead">ユーザーエリア(demo)</p>
      <div>
      ・ユーザー名: sample<br>
      ・残カテゴリ数: <%= "#{Category.active.count}" %><br>
      ・達成カテゴリ数: <%= "#{Category.all.count - Category.active.count} / #{Category.all.count}" %><br>
      </div>
    </div>
  </div>
</div>